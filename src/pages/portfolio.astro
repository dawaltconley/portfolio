---
import Layout from '../layouts/Layout.astro';
import Project from '../components/ProjectPreview.astro';
import { getCollection } from 'astro:content';
import { tags, getExcerpt } from '../data/projects';

import IconLink from '../components/IconLink.astro';

const projects = await getCollection('projects');
---

<Layout title="My projects">
  <div class="site-header mt-8 flex flex-col pt-[10vw]">
    <header class="container mx-auto mt-auto mb-8 px-4 font-serif">
      <h1 class="mb-2 text-7xl font-semibold leading-[0.85]">
        Dylan Awalt-Conley
      </h1>
      <p class="text-3xl font-medium">
        Some of my websites and JavaScript things.
      </p>
    </header>
  </div>
  <main class="container mx-auto px-4 py-8">
    <ul class="grid grid-cols-2 gap-4">
      {
        projects
          .filter((project) => project.data.image)
          .map(async (project) => (
            <Project project={project}>
              <p>{getExcerpt(project)}</p>
            </Project>
          ))
      }
    </ul>
  </main>
  <footer class="space-x-2 p-4">
    {
      Array.from(tags).map((tag) => (
        <IconLink id={tag} type="skill" inline={true} />
      ))
    }
  </footer>
</Layout>

<style lang="scss">
  @use 'scss-properties' as props;

  .site-header {
    @apply relative overflow-hidden;
    &::before,
    &::after {
      content: '';
      @apply absolute inset-0;
    }
    &::before {
      @apply -z-10;
      background-color: props.set(
        --theme-br,
        $hue: adjust -180deg,
        $lightness: change calc(100% - var(--theme-br-l))
      );
      clip-path: polygon(0 5%, 0 100%, 80% 100%);
    }
    &::after {
      background-color: white;
      mix-blend-mode: difference;
      clip-path: polygon(0 0%, 0 100%, 100% 100%, 100% 80%);
    }
  }
</style>
